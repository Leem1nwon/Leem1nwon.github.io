---
layout: single
title: "[Embedded System] Lab01 : AWS EC2 인스턴스, 리눅스 기초"
categories: Embedded_System
---

## 1. AWS EC2 인스턴스

### 1.1 AWS EC2 인스턴스란?
- 아마존이 제공하는 가상 서버
- 그냥 리눅스 깔린 원격 컴퓨터 하나 빌린 거라고 생각하면 됨
- SSH로 접속해서 사용

### 1.2 SSH란?
- 원격 컴퓨터(서버)랑 내 컴퓨터를 연결해서 터미널 명령어 칠 수 있게 해주는 프로토콜
- 내 컴퓨터에서 원격 서버를 조종할 수 있게 해주는 명령어

### 1.3 AWS EC2 인스턴스 시작/접속
- 윈도우 - 명령 프롬프트

`ssh -i [.pem파일경로] ubuntu@[인스턴스 퍼블릭 IPv4 주소]`
`ex) ssh -i "C:\Users\username\Downloads\keyname.pem" ubuntu@13.125.66.204`
 
### 1.4 접속 종료 및 AWS 인스턴스 종료
- **접속 종료**
`$exit`
- **AWS 인스턴스 종료**
  - !!인스턴스를 종료하지 않으면 계속 과금!!
  - 사용하지 않을 때에는 반드시 종료할 것
- **저장**
  - EC2 인스턴스를 종료하면 모든 자료가 사라지기 때문에, 필요한 자료는 종료 전 백업 할 것
---
## 2. 리눅스 기초 명령어 & 툴

### 2.1 Shell & Command

#### 2.1.1 Shell 이란?
- 명령어 처리기
- 커널의 인터페이스를 제공하는 프로그램
  - 명령어 실행
  - 파일 시스템 탐색
  - 환경 변수 설정
  - 스크립팅

#### 2.1.2 Shell script란?
- 텍스트 형식으로 저장되는 프로그램, 한줄씩 순차적으로 읽어 실행
- 컴퓨터에 시킬 명령을 텍스트로 작성하여 실행
- 빠르고 간편함 / 작은 규모의 작업을 빠르게 처리하는데 특화됨

#### 2.1.3 Shell 종류
- sh
  - 본 셸, 또는 B셸이라고 불림
- csh
  - C셸, sh보다 대화형 조작에 편리한 기능을 갖추고 있음
- bash
  - sh를 바탕으로 기능이 추가된 셸
  - 많은 리눅스에서 기본 로그인 셸로 사용하고 있음
- zsh
  - 비교적 최근에 개발된 셸로, 다양한 기능을 갖추고 있음

#### 2.1.4 Shell 유용한 기능
- 자동 완성 기능
  - CLI(Command Line Interface) 환경에서 명령을 매번 입력하는 것은 오타가 생길 수  있음
  - 일부만 입력하고 `tab`키를 누르면 편하다
- 명령 이력 검색
  - `ctrl + r` : 이전에 입력한 명령들을 검색

### 2.2 파일과 디렉터리

#### 2.2.1 리눅스의 주요 디렉터리
- 최상위 디렉터리(/로 표현): 루트 디렉터리
  - `$ cd /`
  - `$ tree - L 1`
- 기타 디렉토리

| 디렉터리 명 | 설명 |
|------------|------------------------------|
| home       | 사용자 홈 디렉터리          |
| media      | USB 등의 외부 장치를 연결    |
| opt        | 추가 패키지 설치             |
| dev        | 장치 파일들 저장             |
| root       | Root 계정의 홈 디렉터리      |
| sys        | 리눅스 커널 관련 정보        |
| usr        | 기본 실행파일과 라이브러리/헤더 파일 등 |
| boot       | 부팅에 필요한 정보           |
| var        | 시스템 운영중 발생한 데이터와 로그 저장 |
| tmp        | 임시 데이터                   |
| srv        | 시스템에서 제공하는 서비스의 데이터 저장 |
| run        | 실행중인 서비스와 관련된 파일이 저장 |
| proc       | 프로세스 정보 등 커널 관련 정보 |
| mnt        | 파일 시스템을 연결하는 위치  |
| etc        | 리눅스 설정을 위한 각종 파일 |

- 현재 위치한 디렉토리
  - current directory or working directory
  - `$ pwd`

#### 2.2.2 경로
- 절대 경로
  - 루트 디렉터리부터 해당 파일에 이르는 경로
  - `/usr/bin/python`
- 상대 경로
  - 현재 디렉터리의 위치를 기준으로 표기하는 경로
  - 현재 위치를 .으로 한 단계 상위 위치를 ..으로 표현
  - 로그인 계정의 홈 디렉터리는 ~로 표현현
  - `ex) 현재 위치가 /usr/lib일 때, /usr/bin/python을 ../bin/python 으로 표기`

#### 2.2.3 * 와 ?
- `*`는 임의의 문자열을 의미
  - `$ ls /usr/bin/python*`
- ?는 임의의 한 문자를 의미
  - `$ ls /usr/bin/python?`

#### 2.2.4 기본 조작법
- 파일 생성/삭제
  - touch 명령어 : 비어있는 내용의 파일 생성
  - rm 명령어 : 파일 삭제

- 파일 내용 출력
  - cat : 파일 전체의 내용을 출력
  - head : 파일의 처음 n 줄을 출력
  - tail : 파일의 마지막 n 줄을 출력
  - less : 화면을 스크롤할 수 있도록 파일 내용을 출력
`$ cat -n /etc/ssh/ssh_config` -n 옵션: 행 번호와 함께 출력
`$ head -n 5 /etc/ssh/ssh_config` -n 옵션: 출력할 줄 수 지정(기본값: 10) 
`$ tail -n 7 /etc/ssh/ssh_config`
`$ less /etc/bash.bashrc` - 위/아래 화살표로 스크롤, 스페이스바로 한 페이지씩 스크롤, 종료시 q 입력

- 파일 복사/이동
  - cp : 복사
    `cp newfile my_directory/copied`
  - mv : 이동
    `mv newfile my_directory/moved`

- 바로가기 만들기
  - 파일에 별명을 붙이는 것
  - 윈도우의 바로가기와 비슷한 기능
  - 심볼릭 링크
  `ln -s file_a file_b` : file_b는 file_a에 접근하는 바로가기
    - file_a를 삭제하면 file_b는 깨짐
    - 디렉터리도 링크 가능

- 파일 검색하기
  - Find 명령어 사용
    - `$ find . -name 'file*' -type f -print` → 현재 디렉터리(.)에서 file로 시작하는 파일만 찾아 출력
    - `-name '파일명'` 옵션으로 파일 이름 검색 가능
    - `-type` 옵션으로 파일 종류(f: 파일, d: 디렉터리, l:심볼릭 링크) 필터링 가능

### 2.3 명령어

#### 2.3.1 명령어 사용법 확인하기 
- 간단히 보는 방법
  - `--help` 옵션 사용 : 궁금한 명령어 뒤에 쓰면 됨
  `$ find --help`
- 자세한 사용법 확인하기
  - `man` 명령어 사용 : 궁금한 명령어 앞에 쓰면 됨
  `$ man find`

#### 2.3.2 명령어의 절대 경로 표시
- 현재 실행하는 명령어가 정확히 어떤 경로에 있는 것인지 확일할 때 사용
  `$ which cat`

#### 2.3.3 명령어를 찾는 경로
- 프롬프트에 명령어 입력 시, 현재 폴더와 $PATH 환경변수에 저장된 장소에서 명령어를 찾음
- 명령어를 찾을 디렉터리를 콜론(:)으로 구분해 설정
    ```bash
    $ echo $PATH
    /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
    ```
- `$PATH` 목록에 없는 실행 파일은 절대경로 혹은 상대경로로 실행해야 함.
    `$ ./myscript.sh` ⟶ 직접 경로 지정해야 실행됨

### 2.4 텍스트 에디터 VIM

- 명령어 모드/입력 모드
  - 처음 vim 실행 시 명령어 모드로 진입
  - 입력 모드로 전환하려면 i 입력
  - 다시 명령어 모드로 전환하려면 ESC 입력
- 저장/종료 하려면 명령어 모드에서 `:wq`

### 2.5 Bash 설정
#### 2.5.1 별칭을 통해 새로운 명령어 지정하기
- alias 라는 명령어를 이용하여 기존 명령어에 별칭을 붙일 수 있음
- `alias cb = 'colcon build'` 사용 시 일시적으로 현재 터미널에서 cb를 대신 사용 가능
- alias를 영구적으로 설정하고 싶을 경우(터미널 재시작해도 유지)
  1. `vim ~/.bashrc` 터미널에 입력
  2. 파일 맨 아래에 다음 내용 추가
    ```
    alias cb='colcon build'
    alias cbc='colcon build --symlink-install'
    alias cr='colcon build --packages-select'
    ```
   3. `source ~/.bashrc` 변경 사항 적용

#### 2.5.2 프롬프트 설정
- 프롬프트란, 명령어 입력하는 줄 앞에 나오는 문자열
- 기본값: `사용자명@호스트명:경로$`
- 이걸 커스텀해서 실용적으로 사용할 수 있음

#### 2.5.3 환경 변수
- 현재 Shell에 설정된 환경 변수를 출력
  `$ printenv`
- 환경 변수 설정
  `$ export LESS='--no-init`

#### 2.5.4 사용자별 설정

| 설정 파일      | 설명                                   |
|--------------|------------------------------------|
| `/etc/profile` | 시스템 전체에 적용되는 설정 (모든 사용자)  |
| `~/.profile`  | 각 사용자별 로그인 시 실행되는 설정       |
| `~/.bashrc`  | 각 사용자별 **터미널 실행 시** 실행되는 설정  |

- 개인 설정을 바꾸려면 `~/.bashrc`를 수정하면 된다.

### 2.6 Permission
- 리눅스에서는 모든 파일과 디렉터리에 접근 권한이 있음
- 파일을 누가 읽고, 쓰고, 실행할 수 있는지 설정할 수 있음

#### 2.6.1 파일의 소유자와 소유 그룹
- 모든 파일에는 소유자가 있음
- 해당 파일에 대한 접근 권한을 자유롭게 설정 가능
    r: 읽기 권한 (4)
    w: 쓰기 권한 (2)
    x: 실행 권한 (1)
```
-rwxr-xr-x

소유자: rwx
소유그룹: r-x
기타 사용자: r-x
```

#### 2.6.2 파일 모드 변경
- 파일이나 디렉터리의 권한을 설정
  - `$ chmod u+w newfile`: 소유자(user)에게 쓰기 권한 추가
  - `$ chmod g-r newfile`: 그룹(group)에서 읽기 권한 제거
  - `$ chmod o+x newfile`: 기타 사용자(other)에게 실행 권한 추가
  - `$ chmod 644 newfile`: rw-r--r-- 소유자는 읽기/쓰기 가능, 그룹/사용자는 읽기만 가능

#### 2.6.3 슈퍼 사용자
- 관리자 권한을 가지는 특별한 사용자
- 시스템 설정 파일을 바꾸거나 새로운 어플리케이션을 설치할 수 있음
- 파일에 설정된 권한을 무시하고 모든 파일을 읽고/수정할 수 있음
- 사용자 전환
  - `$ su`
- 한 명령어만 다른 사용자가 되어서 실행
  - `$ sudo cat /etc/shadow`

## 3. 기타

### 3.1 Redirection
- 리눅스 입력/출력위치 수정
  - 터미널의 표준 스트림을 다른 위치로 변경/저장 할 수 있도록 변경하는 것
    - `$ ls > filename.txt` : ls 명령 수행 결과를 콘솔(모니터)에 찍는 대신, filenames.txt에 저장. 기존 내용을 대체함
    - `$ ls >> filenames.txt`: 위와 유사하나, 기존 내용은 지우지 않고 마지막 줄에 이어서 작성
  - 프로그램의 입력 값을 키보드가 아닌 파일에서 가져오려는 경우에도 사용 가능
    - `$ python add_3.py < input_num.txt >> result.txt`

### 3.2 APT (Advanced Packaging Tool)
- 패키지 관리자
  - 데비안 리눅스 또는 파생된 배포판(우분투)에서 소프트웨어를 설치, 제거, 업데이트 할 때 사용
  - 높은 권한이 필요한 활동에 대해서는 "sudo"를 함께 입력하여 root 권한을 획득해야 함

### 3.3 Pipe
- 명령어의 연결
  - 두 개의 프로그램을 연결해주는 연결 통로
  - 첫 번째 명령의 표준 출력을 두 번째 명령의 표준 입력으로 대체
  - 명령어 결과를 다른 명령어로 넘길 수 있다.
  ```bash
  ls -1 | wc -l  # 디렉터리 안 파일 개수 세기
  cat file.txt | grep "error"  # 특정 단어 포함된 줄 찾기
  ps aux | grep python  # 실행 중인 프로세스 중 python 관련된 것만 보기
  ```